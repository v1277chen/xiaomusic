<!DOCTYPE html>
<html lang="zh-TW">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>歌曲下載工具</title>
	<link rel="stylesheet" type="text/css" href="./main.css?version=1766282679">
	<script src="./jquery-3.7.1.min.js?version=1766282679"></script>

	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-Z09NC1K7ZW"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag() { dataLayer.push(arguments) };
		gtag('js', new Date());
		gtag('config', 'G-Z09NC1K7ZW');
	</script>

	<!-- umami -->
	<script async defer src="https://umami.hanxi.cc/script.js"
		data-website-id="7bfb0890-4115-4260-8892-b391513e7e99"></script>

</head>

<body>

	<h1>歌曲下載工具</h1>

	<div class="rows">
		<!-- 歌单的输入 -->
		<label for="playlistUrl">輸入歌單 URL:</label>
		<input type="text" id="playlistUrl" value="https://m.bilibili.com/video/BV1WUsDezE88">

		<label for="dirname">輸入歌單名字:</label>
		<input type="text" id="dirname" placeholder="流行歌曲">

		<button id="downloadPlaylistBtn">下載歌單</button>

	</div>

	<hr>

	<div class="rows">

		<!-- 单曲的输入 -->
		<label for="songUrl">輸入歌曲 URL:</label>
		<input type="text" id="songUrl" value="https://m.bilibili.com/video/BV1qD4y1U7fs">

		<label for="songName">輸入歌曲名字:</label>
		<input type="text" id="songName" placeholder="歌曲名">

		<button id="downloadSongBtn">下載單曲</button>
	</div>


	<script>
		// 下載歌單
		$('#downloadPlaylistBtn').click(function () {
			var playlistUrl = $('#playlistUrl').val();
			var dirname = $('#dirname').val();

			if (!playlistUrl || !dirname) {
				alert('請填寫完整的歌單 URL 和歌單名字');
				return;
			}

			var data = {
				dirname: dirname,
				url: playlistUrl
			};
			$.ajax({
				type: "POST",
				url: "/downloadplaylist",
				contentType: "application/json",
				data: JSON.stringify(data),
				success: (msg) => {
					alert('歌單下載請求已發送!');
					console.log(response);
				},
				error: (msg) => {
					alert('歌單下載請求失敗，請重試。');
				}
			});
		});

		// 下載單曲
		$('#downloadSongBtn').click(function () {
			var songName = $('#songName').val();
			var songUrl = $('#songUrl').val();

			if (!songUrl || !songName) {
				alert('請填寫完整的歌曲 URL 和歌曲名字');
				return;
			}

			var data = {
				name: songName,
				url: songUrl
			};
			$.ajax({
				type: "POST",
				url: "/downloadonemusic",
				contentType: "application/json",
				data: JSON.stringify(data),
				success: (msg) => {
					alert('單曲下載請求已發送!');
					console.log(response);
				},
				error: (msg) => {
					alert('單曲下載請求失敗，請重試。');
				}
			});
		});
	</script>

</body>

</html>