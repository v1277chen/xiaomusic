import{_ as a,c as i,a0 as e,o as n}from"./chunks/framework.C8sLidy6.js";const d=JSON.parse('{"title":"docker compose 命令行安装教程","description":"","frontmatter":{"title":"docker compose 命令行安装教程"},"headers":[],"relativePath":"issues/360.md","filePath":"issues/360.md","lastUpdated":1749913644000}'),t={name:"issues/360.md"};function l(h,s,p,r,o,k){return n(),i("div",null,s[0]||(s[0]=[e(`<h1 id="docker-compose-命令行安装教程" tabindex="-1">docker compose 命令行安装教程 <a class="header-anchor" href="#docker-compose-命令行安装教程" aria-label="Permalink to &quot;docker compose 命令行安装教程&quot;" target="_self">​</a></h1><p>本教程针对于有命令行环境，且已经安装好 docker compose 的用户。步骤超级简单，基本只要复制粘贴就能跑起来。如果需要修改路径或者端口，可以复制到编辑器，修改后再复制粘贴到命令行执行。编辑时注意不要修改到文件格式，包括缩进。</p><h2 id="创建-docker-compose-yml-文件" tabindex="-1">创建 docker-compose.yml 文件 <a class="header-anchor" href="#创建-docker-compose-yml-文件" aria-label="Permalink to &quot;创建 docker-compose.yml 文件&quot;" target="_self">​</a></h2><p>假设 <code>docker-compose.yml</code> 文件的存放到路径为 <code>/xiaomusic/docker-compose.yml</code> 。执行下面的命令即可：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /xiaomusic</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /xiaomusic/docker-compose.yml</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">services:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  xiaomusic:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    image: docker.hanxi.cc/hanxi/xiaomusic</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    container_name: xiaomusic</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    restart: unless-stopped</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    ports:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      - 58090:8090</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    environment:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      XIAOMUSIC_PUBLIC_PORT: 58090</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    volumes:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      - /xiaomusic_conf:/app/conf</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      - /xiaomusic_music:/app/music</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span></code></pre></div><ul><li><code>/xiaomusic_conf</code> 为配置文件存放目录，一般不需要修改。</li><li><code>/xiaomusic_music</code> 为音乐存放目录，你可以替换为自己想要存放的目录，注意填绝对路径，在 Linux 下是 <code>/</code> 开头的，在 Windows 下是盘符开头，比如： <code>D:/music</code>。</li><li>端口 8090 不要修改，是容器内的端口。</li><li>端口 58090 可以修改，如果想要修改，两个 58090 都需要同时修改，这个端口是访问 web 后台的端口。</li></ul><h2 id="启动" tabindex="-1">启动 <a class="header-anchor" href="#启动" aria-label="Permalink to &quot;启动&quot;" target="_self">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /xiaomusic</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span></span></code></pre></div><p>启动后，就能使用 <a href="http://nasip:58090" target="_self">http://nasip:58090</a> 来访问 web 后台了，把 nasip 替换成你的 nas 的 IP 。</p><h2 id="后台设置" tabindex="-1">后台设置 <a class="header-anchor" href="#后台设置" aria-label="Permalink to &quot;后台设置&quot;" target="_self">​</a></h2><p><img src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/424c45af-6937-4fee-bb7d-855973ef0d5d" alt="image"></p><p>填好账号密码，和自动填 IP 和端口，然后滚动到页面最下面，点击保存按钮。然后刷新设置页面，再勾选小爱音箱，再保存即可。</p><p><img src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/c63c3ff1-3a80-4f47-971e-761eb9187ae0" alt="image"></p><h2 id="更新" tabindex="-1">更新 <a class="header-anchor" href="#更新" aria-label="Permalink to &quot;更新&quot;" target="_self">​</a></h2><p>想要更新镜像，只需要复制粘贴下面的命令就行，注意 <code>/xiaomusic</code> 目录是 <code>docker-compose.yml</code> 文件所在的目录。</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /xiaomusic</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span></span></code></pre></div><h2 id="关闭" tabindex="-1">关闭 <a class="header-anchor" href="#关闭" aria-label="Permalink to &quot;关闭&quot;" target="_self">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /xiaomusic</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> down</span></span></code></pre></div><h2 id="评论" tabindex="-1">评论 <a class="header-anchor" href="#评论" aria-label="Permalink to &quot;评论&quot;" target="_self">​</a></h2><h3 id="评论-1-tiger326" tabindex="-1">评论 1 - tiger326 <a class="header-anchor" href="#评论-1-tiger326" aria-label="Permalink to &quot;评论 1 - tiger326&quot;" target="_self">​</a></h3><p>我用这个是可以正常启动和搭建好xiaomusic, 一切都OK. 不过我的NAS是qnap, 已禁用默认的admin用户, 使用自建的管理员账户登录. 但这个配置会默认使用admin用户执行, 导致一旦产生tmp和download目录以及相关文件, 都归属于admin用户. 结果我自建的用户在NAS上无法删除和编辑这些下载的文件.</p><p>xiaomusic是否支持创建时指定用户和用户组?</p><hr><h3 id="评论-2-hanxi" tabindex="-1">评论 2 - hanxi <a class="header-anchor" href="#评论-2-hanxi" aria-label="Permalink to &quot;评论 2 - hanxi&quot;" target="_self">​</a></h3><p>@tiger326 把下面的 username 换成普通的用户名即可，换成 uid 数字也行，一般是 1000</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /xiaomusic</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /xiaomusic/docker-compose.yml</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">services:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  xiaomusic:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    image: docker.hanxi.cc/hanxi/xiaomusic</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    container_name: xiaomusic</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    restart: unless-stopped</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    user: username</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    ports:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      - 58090:8090</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    environment:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      XIAOMUSIC_PUBLIC_PORT: 58090</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    volumes:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      - /xiaomusic_conf:/app/conf</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      - /xiaomusic_music:/app/music</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span></code></pre></div><hr><h3 id="评论-3-worrywast" tabindex="-1">评论 3 - worrywast <a class="header-anchor" href="#评论-3-worrywast" aria-label="Permalink to &quot;评论 3 - worrywast&quot;" target="_self">​</a></h3><p>为啥我的播放完一首音乐之后，还会播放该歌曲开头一点点才会放下一首呢？</p><hr><h3 id="评论-4-hanxi" tabindex="-1">评论 4 - hanxi <a class="header-anchor" href="#评论-4-hanxi" aria-label="Permalink to &quot;评论 4 - hanxi&quot;" target="_self">​</a></h3><blockquote><p>为啥我的播放完一首音乐之后，还会播放该歌曲开头一点点才会放下一首呢？</p></blockquote><p>正常现象。可以把延迟设置为0试试。</p><hr><h3 id="评论-5-worrywast" tabindex="-1">评论 5 - worrywast <a class="header-anchor" href="#评论-5-worrywast" aria-label="Permalink to &quot;评论 5 - worrywast&quot;" target="_self">​</a></h3><blockquote><blockquote><p>为啥我的播放完一首音乐之后，还会播放该歌曲开头一点点才会放下一首呢？</p></blockquote><p>正常现象。可以把延迟设置为0试试。</p></blockquote><p>是这个选项吗：“下一首歌延迟播放秒数:” 我设置为0，也会有这个现象，只是没有之前播放开头那么多</p><hr><h3 id="评论-6-hanxi" tabindex="-1">评论 6 - hanxi <a class="header-anchor" href="#评论-6-hanxi" aria-label="Permalink to &quot;评论 6 - hanxi&quot;" target="_self">​</a></h3><p>@worrywast 等下个版本我优化一下，允许设置成负数吧。</p><hr><h3 id="评论-7-worrywast" tabindex="-1">评论 7 - worrywast <a class="header-anchor" href="#评论-7-worrywast" aria-label="Permalink to &quot;评论 7 - worrywast&quot;" target="_self">​</a></h3><blockquote><p><a href="https://github.com/worrywast" target="_self">@worrywast</a> 等下个版本我优化一下，允许设置成负数吧。</p></blockquote><p>辛苦大佬~</p><hr><h3 id="评论-8-hanxi" tabindex="-1">评论 8 - hanxi <a class="header-anchor" href="#评论-8-hanxi" aria-label="Permalink to &quot;评论 8 - hanxi&quot;" target="_self">​</a></h3><p>@worrywast 现在就是可以填负数的，你可以试试看。</p><hr><p><a href="https://github.com/hanxi/xiaomusic/issues/360" target="_self">链接到 GitHub Issue</a></p>`,49)]))}const F=a(t,[["render",l]]);export{d as __pageData,F as default};
